{% extends 'authoring/base.html' %}
{% block content %}
<section>
    <header>
        <h2>{{ 'Create Post' if is_new else 'Edit Post' }}</h2>
    </header>

    <section class="media-upload">
        <h3>Upload images, video, or audio</h3>
        <p>
            Use this uploader to add media files to
            <code>{{ media_url_prefix }}</code>. After the upload completes, copy
            the flashed URL into the Hero image field or embed it in your
            Markdown using standard Markdown image syntax or an HTML
            <code>&lt;video&gt;</code>/<code>&lt;audio&gt;</code> tag.
        </p>
        <form
            method="post"
            action="{{ url_for('authoring.upload_media') }}"
            enctype="multipart/form-data"
        >
            <input type="hidden" name="next" value="{{ request.full_path }}">
            <label>
                Choose file
                <input name="media_file" type="file" required>
            </label>
            <button type="submit">Upload media</button>
        </form>
    </section>

    <form method="post">
        <input type="hidden" name="original_slug" value="{{ post_data.original_slug }}">
        <label>
            Title
            <input name="title" type="text" value="{{ post_data.title }}" required>
        </label>
        <label>
            Slug
            <input name="slug" type="text" value="{{ post_data.slug }}" placeholder="auto-from-title">
        </label>
        <label>
            Date
            <input name="date" type="date" value="{{ post_data.date }}">
        </label>
        <label>
            Description
            <textarea name="description" rows="2">{{ post_data.description }}</textarea>
        </label>
        <label>
            Excerpt
            <textarea name="excerpt" rows="3">{{ post_data.excerpt }}</textarea>
        </label>
        <label>
            Hero image URL
            <input name="hero_image" type="text" value="{{ post_data.hero_image }}" placeholder="/static/images/...">
        </label>
        <label>
            <input name="featured" type="checkbox" {% if post_data.featured %}checked{% endif %}> Featured post
        </label>
        <label>
            Content (Markdown)
            <textarea name="content" required>{{ post_data.content }}</textarea>
        </label>
        <footer class="actions">
            <button type="submit">Save post</button>
            <a class="secondary" role="button" href="{{ url_for('authoring.dashboard') }}">Cancel</a>
            {% if not is_new %}
                <a class="secondary" role="button" href="{{ url_for('authoring.preview_post', slug=post_data.slug or post_data.original_slug) }}" target="_blank">Preview</a>
            {% endif %}
        </footer>
    </form>
</section>
{% endblock %}
